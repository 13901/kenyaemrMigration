<?xml version="1.0" encoding="UTF-8"?>
<transformation>
  <info>
    <name>Transform_hiv_followup</name>
    <description/>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/</directory>
    <parameters>
      <parameter>
        <name>mysql_tr</name>
        <default_value/>
        <description/>
      </parameter>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>10000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>50000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>-</created_user>
    <created_date>2019/12/16 16:20:34.484</created_date>
    <modified_user>-</modified_user>
    <modified_date>2019/12/16 16:20:34.484</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>mysql_tr</name>
    <server>localhost</server>
    <type>MYSQL</type>
    <access>JNDI</access>
    <database>mysql_tr</database>
    <port>3306</port>
    <username/>
    <password>Encrypted </password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
  </order>
  <step>
    <name>load_tr_hiv_followup</name>
    <type>ExecSQL</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>mysql_tr</connection>
    <execute_each_row>N</execute_each_row>
    <single_statement>N</single_statement>
    <replace_variables>N</replace_variables>
    <quoteString>N</quoteString>
    <sql>-- 17. HIV Followup transformed table
  DROP TABLE IF EXISTS migration_tr.tr_hiv_followup;
 CREATE TABLE migration_tr.tr_hiv_followup
    select
  Person_Id,
  Encounter_Date,
  Encounter_ID,
  (case Visit_scheduled when "Yes" then 1
                        when "No" then 2 else NULL end )as Visit_scheduled,
  (case Visit_by when "S" then 978
                 when "TS" then 161642 else NULL end )as Visit_by,
  Visit_by_other,
  (case Nutritional_status when "Normal" then 978
                           when "Severe Acute Malnutrition" then 163302
                           when "Moderate Acute Malnutrition" then 163303
                           when "Overweight/Obese" then 114413 else NULL end )as Nutritional_status,
  (case Population_type when "General Population" then 164928
                        when "Key Population" then 164929 else NULL end) as Population_type,
  (case Key_population_type when "People who Inject with Drugs" then 105 else NULL end) as Key_population_type_pwid,
  (case Key_population_type  when "Men having Sex with Men" then 160578 else NULL end) as Key_population_type_msm,
  (case Key_population_type when "Female Sex Worker" then 160579 else NULL end) as Key_population_type_fsw,
  (case Who_stage when "Stage1" then 1204
                  when "Stage2" then 1205
                  when "Stage3" then 1206
                  when "Stage4" then 1207 else NULL end )as Who_stage,
  (case Presenting_complaints
       when "Yes" then 1065
       when "No" then 1066  else NULL end)as Presenting_complaints,
#   (case Complaint
#        when "Weight loss" then 832
#        when "Vomiting" then 122983
#        when "Vertigo" then 111525
#        when "Urinary symptoms Pain/frequency/Urgency" then 160208
#        when "Tremors" then 112200
#        when "Swollen legs" then 125198
#        when "Sweating-excessive" then 140941
#        when "Sore Throat" then 158843
#        when "Sleep disturbance" then 141597
#        when "Shoulder pain" then 126535
#        when "Scrotal pain" then 131032
#        when "Runny/blocked nose" then 113224
#        when "Ringing/Buzzing ears" then 117698
#        when "Red eye" then 127777
#        when "Rash" then 512
#        when "Poor Vision" then 5953
#        when "Pelvic pain" then 131034
#        when "Pain when swallowing" then 125225
#        when "Numbness" then 132653
#        when "Night Sweats" then 133027
#        when "Neck pain" then 133469
#        when "Nausea" then 5978
#        when "Muscle pain" then 133632
#        when "Muscle cramps" then 133028
#        when "Mouth ulcers" then 111721
#        when "Mouth pain/burning" then 131015
#        when "Mental status, acute change (coma, lethargy)" then 144576
#        when "Memory loss" then 121657
#        when "Lymphadenopathy" then 135488
#        when "Loss of appetite" then 135595
#        when "Leg pain" then 114395
#        when "Joint Pain" then 116558
#        when "Itchiness/Pruritus" then 879
#        when "Hypotension/Shock" then 116214
#        when "Hearing loss" then 117698
#        when "Headache" then 139084
#        when "Genital skin lesion/Ulcer" then 135462
#        when "Genital Discharge" then 123396
#        when "Flank pain" then 140070
#        when "Fever" then 140238
#        when "Fatigue/weakness" then 162626
#        when "Facial pain" then 114399
#        when "Eye pain" then 131040
#        when "Epigastric Pain" then 141128
#        when "Ear pain" then 141585
#        when "Dizziness" then 141830
#        when "Difficulty in swallowing" then 118789
#        when "Difficult in breathing" then 122496
#        when "Diarrhoea" then 142412
#        when "Crying infant" then 143129
#        when "Cough" then 143264
#        when "Convulsions/Seizure" then 206
#        when "Confusion/Delirium" then 119574
#        when "Cold/Chills" then 871
#        when "Chest pain" then 120749
#        when "Breast pain" then 131021
#        when "Bloody Urine" then 840
#        when "Back pain" then 148035
#        when "Anxiety, depression" then 119537
#        when "Abnormal uterine bleeding" then 141631
#        when "Abdominal pain" then 151
#        when "Other" then 5622  else '' end)as Complaint,
#   Duration,
#   Onset_Date,
#   Clinical_notes,
  (case Has_known_allergies
       when "Yes" then 1065
       when "No" then 1066  else NULL end)as Has_known_allergies,
#   (case Allergies_causative_agents
#        when "Ragweed" then 162541
#        when "Pollen" then 162540
#        when "Mold" then 162539
#        when "Latex" then 162538
#        when "Dust" then 162537
#        when "Bee stings" then 162536
#        when "Adhesive tape" then 162542
#        when "Wheat" then 162177
#        when "Strawberries" then 162548
#        when "Soy" then 162176
#        when "Shellfish" then 162175
#        when "Peanuts" then 162172
#        when "Milk protein" then 162547
#        when "Fish" then 162546
#        when "Eggs" then 162171
#        when "Dairy food" then 162545
#        when "Chocolate" then 162544
#        when "Caffeine" then 72609
#        when "Beef" then 162543
#        when "Zidovudine" then 86663
#        when "Tetracyline" then 84893
#        when "Tenofovir" then 84795
#        when "Sulfonamides" then 162170
#        when "Stavudine" then 84309
#        when "Statins" then 162307
#        when "Rifampin" then 767
#        when "Quinidine" then 83018
#        when "Pyrazinamide" then 82900
#        when "Procainamide" then 82559
#        when "Phenytoin" then 82023
#        when "Phenolphthaleins" then 81959
#        when "Penicillins" then 81724
#        when "Penicillamine" then 81723
#        when "Non-steroidal anti-inflammatory drugs" then 162306
#        when "Nitrofurans" then 158005
#        when "Nevirapine" then 80586
#        when "Morphine" then 80106
#        when "Lopinavir/ritonavir" then 794
#        when "Isoniazid" then 78280
#        when "Hydralazine" then 77675
#        when "Heparins" then 162305
#        when "Griseofulvin" then 77164
#        when "Ethambutol" then 75948
#        when "Erythromycins" then 162302
#        when "Efavirenz" then 75523
#        when "Didanosine" then 74807
#        when "Codeine" then 73667
#        when "Choloroquine" then 73300
#        when "Cephalosporins" then 162301
#        when "Carbamazepine" then 72822
#        when "Atazanavir" then 71647
#        when "Aspirin" then 155175
#        when "ARBs (angiotensin II receptor blockers)" then 162299
#        when "Aminoglycosides" then 155060
#        when "Allopurinol" then 70878
#        when "ACE inhibitors" then 162298
#        when "Abacavir" then 70056
#        when "Other" then 5622 else '' end)as Allergies_causative_agents,
#   (case Allergies_reactions
#        when "Unknown" then 1067
#        when "Anaemia" then 121629
#        when "Anaphylaxis" then 148888
#        when "Angioedema" then 148787
#        when "Arrhythmia" then 120148
#        when "Bronchospasm" then 108
#        when "Cough" then 143264
#        when "Diarrhea" then 142412
#        when "Dystonia" then 118773
#        when "Fever" then 140238
#        when "Flushing" then 140039
#        when "GI upset" then 139581
#        when "Headache" then 139084
#        when "Hepatotoxicity" then 159098
#        when "Hives" then 111061
#        when "Hypertension" then 117399
#        when "Itching" then 879
#        when "Mental status change" then 121677
#        when "Musculoskeletal pain" then 159347
#        when "Myalgia" then 121
#        when "Rash" then 512
#        when "Other" then 5622   else '' end)as Allergies_reactions,
#   (case Allergies_severity
#        when "Mild" then 160754
#        when "Moderate" then 160755
#        when "Severe" then 160756
#        when "Fatal" then 160758
#        when "Unknown" then 1067  else '' end)as Allergies_severity,
  (case Has_Chronic_illnesses_cormobidities
       when "Yes" then 1065
       when "No" then 1066  else NULL end)as Has_Chronic_illnesses_cormobidities,
#   (case Chronic_illnesses_name
#        when "Alzheimer's Disease and other Dementias" then 149019
#        when "Arthritis" then 148432
#        when "Asthma" then 153754
#        when "Cancer" then 159351
#        when "Cardiovascular diseases" then 119270
#        when "Chronic hepatitis" then 120637
#        when "Chronic Kidney Disease" then 145438
#        when "Chronic Obstructive Pulmonary Disease (COPD)" then 1295
#        when "Chronic renal failure" then 120576
#        when "Cystic Fibrosis" then 119692
#        when "Deafness and hearing impairment" then 120291
#        when "Diabetes" then 119481
#        when "Endometriosis" then 118631
#        when "Epilepsy" then 117855
#        when "Glaucoma" then 117789
#        when "Heart Disease" then 139071
#        when "Hyperlipidaemia" then 115728
#        when "Hypertension" then 117399
#        when "Hypothyroidism" then 117321
#        when "Mental illness" then 151342
#        when "Multiple Sclerosis" then 133687
#        when "Obesity" then 115115
#        when "Osteoporosis" then 114662
#        when "Sickle Cell Anemia" then 117703
#        when "Thyroid disease" then 118976 else '' end)as Chronic_illnesses_name,
#   Chronic_illnesses_onset_date,
(case Has_adverse_drug_reaction
       when "Yes" then 1065
       when "No" then 1066  else NULL end)as Has_adverse_drug_reaction,
#   (case Medicine_causing_drug_reaction
#        when "Ragweed" then 162541
#        when "Pollen" then 162540
#        when "Mold" then 162539
#        when "Latex" then 162538
#        when "Dust" then 162537
#        when "Bee stings" then 162536
#        when "Adhesive tape" then 162542
#        when "Wheat" then 162177
#        when "Strawberries" then 162548
#        when "Soy" then 162176
#        when "Shellfish" then 162175
#        when "Peanuts" then 162172
#        when "Milk protein" then 162547
#        when "Fish" then 162546
#        when "Eggs" then 162171
#        when "Dairy food" then 162545
#        when "Chocolate" then 162544
#        when "Caffeine" then 72609
#        when "Beef" then 162543
#        when "Zidovudine" then 86663
#        when "Tetracyline" then 84893
#        when "Tenofovir" then 84795
#        when "Sulfonamides" then 162170
#        when "Stavudine" then 84309
#        when "Statins" then 162307
#        when "Rifampin" then 767
#        when "Quinidine" then 83018
#        when "Pyrazinamide" then 82900
#        when "Procainamide" then 82559
#        when "Phenytoin" then 82023
#        when "Phenolphthaleins" then 81959
#        when "Penicillins" then 81724
#        when "Penicillamine" then 81723
#        when "Non-steroidal anti-inflammatory drugs" then 162306
#        when "Nitrofurans" then 158005
#        when "Nevirapine" then 80586
#        when "Morphine" then 80106
#        when "Lopinavir/ritonavir" then 794
#        when "Isoniazid" then 78280
#        when "Hydralazine" then 77675
#        when "Heparins" then 162305
#        when "Griseofulvin" then 77164
#        when "Ethambutol" then 75948
#        when "Erythromycins" then 162302
#        when "Efavirenz" then 75523
#        when "Didanosine" then 74807
#        when "Codeine" then 73667
#        when "Choloroquine" then 73300
#        when "Cephalosporins" then 162301
#        when "Carbamazepine" then 72822
#        when "Atazanavir" then 71647
#        when "Aspirin" then 155175
#        when "ARBs (angiotensin II receptor blockers)" then 162299
#        when "Aminoglycosides" then 155060
#        when "Allopurinol" then 70878
#        when "ACE inhibitors" then 162298
#        when "Abacavir" then 70056
#        when "Other" then 5622 else '' end)as Medicine_causing_drug_reaction,
#   (case Drug_reaction
#        when "Unknown" then 1067
#        when "Anaemia" then 121629
#        when "Anaphylaxis" then 148888
#        when "Angioedema" then 148787
#        when "Arrhythmia" then 120148
#        when "Bronchospasm" then 108
#        when "Cough" then 143264
#        when "Diarrhea" then 142412
#        when "Dystonia" then 118773
#        when "Fever" then 140238
#        when "Flushing" then 140039
#        when "GI upset" then 139581
#        when "Headache" then 139084
#        when "Hepatotoxicity" then 159098
#        when "Hives" then 111061
#        when "Hypertension" then 117399
#        when "Itching" then 879
#        when "Mental status change" then 121677
#        when "Musculoskeletal pain" then 159347
#        when "Myalgia" then 121
#        when "Rash" then 512
#        when "Other" then 5622   else '' end)as Drug_reaction,
#   (case Drug_reaction_severity
#        when "Mild" then 160754
#        when "Moderate" then 160755
#        when "Severe" then 160756
#        when "Fatal" then 160758
#        when "Unknown" then 1067  else '' end)as Drug_reaction_severity,
#   Drug_reaction_onset_date,
#  (case Drug_reaction_action_taken
#        when "CONTINUE REGIMEN" then 1257
#        when "SWITCHED REGIMEN" then 1259
#        when "CHANGED DOSE" then 981
#        when "SUBSTITUTED DRUG" then 1258
#        when "NONE" then 1107
#        when "STOP" then 1260
#        when "OTHER" then 5622  else '' end)as Drug_reaction_action_taken,
   (case Vaccinations_today when "BCG" then 886 else NULL end)as Vaccinations_today_bcg,
   (case Vaccinations_today when "OPV" then 82215 when "IPV" then 82215 else NULL end)as Vaccinations_today_pv,
   (case Vaccinations_today when "Penta" then 1423 else NULL end)as Vaccinations_today_penta,
   (case Vaccinations_today when "Pneumococcal" then 162342 else NULL end)as Vaccinations_today_pcv,
   (case Vaccinations_today when "Measles" then 36 else NULL end)as Vaccinations_today_measles,
   (case Vaccinations_today when "HBV" then 782 else NULL end)as Vaccinations_today_hbv,
   (case Vaccinations_today when "Flu" then 5261 else NULL end)as Vaccinations_today_flu,
#    (case Vaccinations_today when "Rota" then 83531 else NULL end)as Vaccinations_today_rota,
   (case Vaccinations_today when "Other" then 5622 else NULL end)as Vaccinations_today_other,
   Null as Vaccinations_today_other_nc,
   Last_menstrual_period,
  (case Pregnancy_status
       when "Pregnant" then 1065
       when "Not Pregnant" then 1066 else NULL end)as Pregnancy_status,
  (case Wants_pregnancy
       when "Yes" then 1065
       when "No" then 1066 else NULL end)as Wants_pregnancy,
#   (case Pregnancy_outcome
#        when "STILLBIRTH" then 125872
#        when "Term birth of newborn" then 1395
#        when "Liveborn, (Single, Twin, or Multiple)" then 151849
#        when "Unknown" then 1067 else '' end)as Pregnancy_outcome,
  Anc_number,
  (case Anc_profile
       when "Yes" then 1065
       when "No" then 1066 else NULL end)as Anc_profile,
  Expected_delivery_date,
  Gravida,
  Parity_term,
  Parity_abortion,
  (case Family_planning_status
       when "Family Planning" then 965
       when "No Family Planning" then 160652
       when "Wants Family Planning" then 1360 else NULL end)as Family_planning_status,
#  (case Family_planning_method when "Emergency contraceptive pills" then 160570
#                               when "Oral Contraceptives Pills" then 780
#                               when "Injectible" then 5279
#                               when "Implant" then 1359
#                               when "Intrauterine Device" then 5275
#                               when "Lactational Amenorhea Method" then 136163
#                               when "Diaphram/Cervical Cap"  then 5278
#                               when "Fertility Awareness" then 5277
#                               when "Tubal Ligation"  then 1472
#                               when "Condoms" then 190
#                               when "Vasectomy" then 1489 else "" end) as Family_planning_method,
#  (case Reason_not_using_family_planning when "Not Sexually Active now" then 160573
#        when "Currently Pregnant" then 1434
#        when "Thinks can’t get pregnant" then 160572
#        when "Wants to get pregnant" then 160571 else "" end) as Reason_not_using_family_planning,
#   (case General_examinations_findings when "Oral thrush" then 5334
#        when "Lymph nodes axillary" then 126952
#        when "Finger Clubbing" then 140125
#        when "Pallor" then 5245
#        when "Oedema" then 460
#        when "Lymph nodes inguinal" then 126939
#        when "Dehydration" then 142630
#        when "Lethargic" then 116334
#        when "Jaundice" then 136443
#        when "Cyanosis" then 143050
#        when "Wasting" then 823
#        when "None" then  1107 else "" end) as General_examinations_findings,
#   (case System_review_finding
#        when "Yes" then 1115
#        when "No" then 1116 else '' end)as System_review_finding,
#  (case Skin
#        when "Skin Eruptions/Rashes" then 1249
#        when "Sores" then 1249
#        when "Oral sores" then 5244
#        when "Growths/Swellings" then 125201
#        when "Itching" then 136455
#        when "Abscess" then 150555
#        when "Swelling/Growth" then 125201
#        when "Hair Loss" then 135591
#        when "Kaposi Sarcoma" then 507 else '' end)as Skin,
#   Skin_finding_notes,
#   (case Eyes
#        when "Irritation" then 123074
#        when "Visual Disturbance" then 123074
#        when "Excessive tearing" then 140940
#        when "Eye pain" then 131040
#        when "Eye redness" then 127777
#        when "Light sensitive" then 140827
#        when "Itchy eyes" then 139100 else '' end)as Eyes,
#   Eyes_finding_notes,
#   (case ENT
#        when "Pain" then 160285
#        when "Discharge" then 128055
#        when "Sore Throat" then 158843
#        when "Tinnitus" then 123588
#        when "Apnea" then 117698
#        when "Hearing disorder" then 117698
#        when "Dental caries" then 119558
#        when "Erythema" then 118536
#        when "Frequent colds" then 106
#        when "Gingival bleeding" then 147230
#        when "Hairy cell leukoplakia" then 135841
#        when "Hoarseness" then 138554
#        when "Kaposi Sarcoma" then 507
#        when "Masses" then 152228
#        when "Nasal discharge" then 152228
#        when "Nosebleed" then 133499
#        when "Nasal discharge" then 128055
#        when "Post nasal discharge" then 110099
#        when "Sinus problems" then 126423
#        when "Snoring" then 126318
#        when "Oral sores" then 5244
#        when "Thrush" then 5334
#        when "Toothache" then 124601
#        when "Ulcers" then 123919
#        when "Vertigo" then 111525 else '' end)as ENT,
#   ENT_finding_notes,
#       (case Chest
#        when "Bronchial breathing" then 146893
#        when "Crackles" then 127640
#        when "Dullness" then 145712
#        when "Reduced breathing" then 164440
#        when "Respiratory distress" then 127639
#        when "Wheezing" then 5209 else '' end)as Chest,
#   Chest_finding_notes,
#   (case CVS
#        when "Elevated blood pressure" then 140147
#        when "Irregular heartbeat" then 136522
#        when "Cardiac murmur" then 562
#        when "Cardiac rub" then 130560  else '' end)as CVS,
#   CVS_finding_notes,
#   (case Abdomen
#        when "Abdominal distension" then 150915
#        when "Distension" then 150915
#        when "Hepatomegaly" then 5008
#        when "Abdominal mass" then 5103
#        when "Mass" then 5103
#        when "Splenomegaly" then 5009
#        when "Abdominal tenderness" then 5105
#        when "Tenderness" then 5105 else '' end)as Abdomen,
#   Abdomen_finding_notes,
#  (case CNS
#        when "Altered sensations" then 118872
#        when "Bulging fontenelle" then 1836
#        when "Abnormal reflexes" then 150817
#        when "Confusion" then 120345
#        when "Confused" then 120345
#        when "Limb weakness" then 157498
#        when "Stiff neck" then 112721
#        when "Kernicterus" then 136282 else '' end)as CNS,
#   CNS_finding_notes,
#  (case Genitourinary
#        when "Bleeding" then 147241
#        when "Rectal discharge" then 154311
#        when "Urethral discharge" then 123529
#        when "Vaginal discharge" then 123396
#        when "Ulceration" then 124087 else '' end)as Genitourinary,
#   Genitourinary_finding_notes,
#   Diagnosis,
#   Treatment_plan,
  (case Ctx_adherence
       when "Good" then 159405
       when "Fair" then 163794
       when "Inadequate" then 159407
       when "Poor" then 159407 else NULL end)as Ctx_adherence,
  (case Ctx_dispensed
       when "Yes" then 1065
       when "No" then 1066 else NULL end)as Ctx_dispensed,
  (case Dapsone_adherence
       when "Good" then 159405
       when "Fair" then 163794
       when "Inadequate" then 159407
       when "Poor" then 159407 else NULL end)as Dapsone_adherence,
  (case Dapsone_dispensed
       when "Yes" then 1065
       when "No" then 1066 else NULL end)as Dapsone_dispensed,
#   (case Morisky_forget_taking_drugs
#        when "Yes" then 1065
#        when "No" then 1066 else '' end)as Morisky_forget_taking_drugs,
#   (case Morisky_careless_taking_drugs
#        when "Yes" then 1065
#        when "No" then 1066 else '' end)as Morisky_careless_taking_drugs,
#   (case Morisky_stop_taking_drugs_feeling_worse
#        when "Yes" then 1065
#        when "No" then 1066 else '' end)as Morisky_stop_taking_drugs_feeling_worse,
#   (case Morisky_stop_taking_drugs_feeling_better
#        when "Yes" then 1065
#        when "No" then 1066 else '' end)as Morisky_stop_taking_drugs_feeling_better,
#   (case Morisky_took_drugs_yesterday
#        when "Yes" then 1065
#        when "No" then 1066 else '' end)as Morisky_took_drugs_yesterday,
#   (case Morisky_stop_taking_drugs_symptoms_under_control
#        when "Yes" then 1065
#        when "No" then 1066 else '' end)as Morisky_stop_taking_drugs_symptoms_under_control,
#   (case Morisky_feel_under_pressure_on_treatment_plan
#        when "Yes" then 1065
#        when "No" then 1066 else '' end)as Morisky_feel_under_pressure_on_treatment_plan,
#   (case Morisky_how_often_difficulty_remembering
#        when "Sometimes" then 1385
#        when "Once in a while" then 159416
#        when "Never/Rarely" then 1090
#        when "Usually" then 1804
#        when "All the time" then 1358 else '' end)as Morisky_how_often_difficulty_remembering,
  (case Arv_adherence
       when "Good" then 159405
       when "Fair" then 163794
       when "Inadequate" then 159407
       when "Poor" then 159407 else NULL end)as Arv_adherence,
  (case Condom_provided
       when "Yes" then 1065
       when "No" then 1066 else NULL end)as Condom_provided,
  (case Screened_for_substance_abuse
       when "Yes" then 1065
       when "No" then 1066 else NULL end)as Screened_for_substance_abuse,
  (case Pwp_disclosure
       when "Yes" then 1065
       when "No" then 1066 else NULL end)as Pwp_disclosure,
  (case Pwp_partner_tested
       when "Yes" then 1065
       when "No" then 1066 else NULL end)as Pwp_partner_tested,
  (case Cacx_screening
       when "Yes" then 1065
       when "yes" then 1065
       when "No" then 1066
       when "Never" then 1090
       when "Not Applicable" then 1175 end)as Cacx_screening,
  (case Screened_for_sti
       when "Yes" then 1065
       when "No" then 1066 else NULL end)as Screened_for_sti,
  (case Sti_partner_notification
       when "Yes" then 1065
       when "No" then 1066 when "Never" then 1066 when "N/A" then 1175 else NULL end)as Sti_partner_notification,
  (case Stability
       when "Stable" then 1
       when "Unstable" then 2 else NULL end)as Stability,
  Next_appointment_date,
(case Next_appointment_reason
       when "Follow Up" then 160523
       when "Lab Tests" then 1283
       when "Counseling" then 159382
       when "Pharmacy Refill" then 160521
       when "Treatment Preparation" then 159382
       when "ART Fast Track Referral" then 160521
       when "Other" then 5622 else NULL end)as Next_appointment_reason,
#   (case Appointment_type
#        when "Standard Care" then 164942
#        when "Express Care" then 164943
#        when "Fast Track" then 164943
#        when "Facility ART Distribution Group" then 164946
#        when "Community Based Dispensing" then 164944
#        when "Community ART Distribution - HCW Led" then 164944
#        when "Community ART Distribution - Peer Led" then 164945
#        when "Other" then 5622 else '' end)as Appointment_type,
  (case Differentiated_care
       when "Yes" then 164947
       when "No" then 164942 else NULL end)as Differentiated_care,
  Voided
 FROM migration_st.st_hiv_followup WHERE (Encounter_Date != "" OR Encounter_Date IS NOT NULL)
  GROUP BY Person_Id, Encounter_Date;;

</sql>
    <set_params>N</set_params>
    <insert_field/>
    <update_field/>
    <delete_field/>
    <read_field/>
    <arguments>
    </arguments>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>192</xloc>
      <yloc>80</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes/>
</transformation>
